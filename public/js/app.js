"use strict";var DraftApp=angular.module("DraftApp",["ngRoute","ngMessages","ngAnimate","ui.router","ui.bootstrap","angular-confirm","AppController","AuthenticationService","ChatController","DashboardController","DraftService","LeagueController","LeagueService","PlayerController","UserController","ChatFactory","DraftFactory","LeagueFactory","UserFactory"]);angular.module("DraftApp").config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/"),e.state("index",{url:"/",views:{content:{templateProvider:["$templateCache",function(e){return e.get("welcome.html")}],controller:"AppController",controllerAs:"vm"}}}).state("login",{url:"/login",views:{header:{templateProvider:["$templateCache",function(e){return e.get("app.html")}],controller:"AppController",controllerAs:"vm"},content:{templateProvider:["$templateCache",function(e){return e.get("login.html")}],controller:"UserController",controllerAs:"vm"}}}).state("register",{url:"/register",views:{header:{templateProvider:["$templateCache",function(e){return e.get("app.html")}],controller:"AppController",controllerAs:"vm"},content:{templateProvider:["$templateCache",function(e){return e.get("register.html")}],controller:"UserController",controllerAs:"vm"}}}).state("dashboard",{url:"/dashboard",authenticate:!0,resolve:function(){AuthenticationService.currentUser()},views:{header:{templateProvider:["$templateCache",function(e){return e.get("app.html")}],controller:"AppController",controllerAs:"vm"},content:{templateProvider:["$templateCache",function(e){return e.get("dashboard.html")}],controller:"DashboardController",controllerAs:"vm"}}}).state("newLeague",{url:"/league/new",authenticate:!0,views:{header:{templateProvider:["$templateCache",function(e){return e.get("app.html")}],controller:"AppController",controllerAs:"vm"},content:{templateProvider:["$templateCache",function(e){return e.get("league/newLeague.html")}],controller:"LeagueController",controllerAs:"vm"}}}).state("joinLeague",{url:"/league/join",authenticate:!0,views:{header:{templateProvider:["$templateCache",function(e){return e.get("app.html")}],controller:"AppController",controllerAs:"vm"},content:{templateProvider:["$templateCache",function(e){return e.get("league/joinLeague.html")}],controller:"LeagueController",controllerAs:"vm"}}}).state("league/{id}",{url:"/league/{id}",authenticate:!0,views:{header:{templateProvider:["$templateCache",function(e){return e.get("app.html")}],controller:"AppController",controllerAs:"vm"},content:{templateProvider:["$templateCache",function(e){return e.get("league/index.html")}],controller:"LeagueController",controllerAs:"vm"}}}).state("settings",{url:"/settings",authenticate:!0,views:{header:{templateProvider:["$templateCache",function(e){return e.get("app.html")}],controller:"AppController",controllerAs:"vm"},content:{templateProvider:["$templateCache",function(e){return e.get("settings.html")}],controller:"UserController",controllerAs:"vm"}}}).state("commish",{url:"/commish",authenticate:!0,views:{header:{templateProvider:["$templateCache",function(e){return e.get("app.html")}],controller:"AppController",controllerAs:"vm"},content:{templateProvider:["$templateCache",function(e){return e.get("commish.html")}],controller:"LeagueController",controllerAs:"vm"}}}).state("availablePlayers",{url:"/availablePlayers",authenticate:!0,views:{header:{templateProvider:["$templateCache",function(e){return e.get("app.html")}],controller:"AppController",controllerAs:"vm"},content:{templateProvider:["$templateCache",function(e){return e.get("availablePlayers.html")}],controller:"PlayerController",controllerAs:"vm"}}}).state("draftboard",{url:"/draftboard",authenticate:!0,views:{header:{templateProvider:["$templateCache",function(e){return e.get("app.html")}],controller:"AppController",controllerAs:"vm"},content:{templateProvider:["$templateCache",function(e){return e.get("draftBoard.html")}],controller:"PlayerController",controllerAs:"vm"}}}).state("chat",{url:"/chat",authenticate:!0,views:{header:{templateProvider:["$templateCache",function(e){return e.get("app.html")}],controller:"AppController",controllerAs:"vm"},content:{templateProvider:["$templateCache",function(e){return e.get("chat.html")}],controller:"ChatController",controllerAs:"vm"}}})}]),angular.module("DraftApp").run(["$transitions","$location","$state","$q","AuthenticationService",function(e,t,n,r,o){e.onStart({to:"*"},function(e){var t=e.injector().get("AuthenticationService");e.to().authenticate&&!t.isLoggedIn()&&n.transitionTo("login")})}]),angular.module("AppController",[]).controller("AppController",["$scope","$location","$q","$state","AuthenticationService","DraftService","LeagueService",function(e,t,n,r,o,l,a){var c=this;c.isLoggedIn=!1,o.isLoggedIn().then(function(e){1==e&&(c.isLoggedIn=!0),0==e&&(c.isLoggedIn=!1)},function(e){console.log(e)}),c.currentUser={},o.currentUser().then(function(e){c.currentUser=e},function(e){console.log(e)}),c.currentLeague=a.currentLeague(),c.setCurrentLeague=function(e){return a.setCurrentLeagueId(e).then(function(){return a.getLeague().then(function(){r.reload()},function(e){console.log(e)})},function(e){console.log(e)})},c.deleteAllDBs=function(){l.deleteAllPlayers(),o.deleteAllUsers(),a.deleteAllChat(),l.deleteAllDrafts()},c.downloadPlayers=function(){l.downloadPlayers(function(e){console.log(e)})},c.deleteAllPlayers=function(){l.deleteAllPlayers(function(e){console.log(e)})},c.deleteAllUsers=function(){o.deleteAllUsers(),t.path("/login")},c.deleteAllChat=function(){a.deleteAllChat()},c.deleteAllLeagues=function(){a.deleteAllLeagues()},c.deleteAllDrafts=function(){l.deleteAllDrafts()},c.currentUserLogOut=function(){o.currentUserLogOut()}}]),angular.module("ngEnter",[]).directive("ngEnter",["$scope","element","attrs",function(e,t,n){t.bind("keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.ngEnter)}),t.preventDefault())})}]),angular.module("ChatController",[]).controller("ChatController",["$scope","AuthenticationService","LeagueService","ChatFactory",function(e,t,n,r){var o=this;o.currentUser=t.currentUser(),o.currentLeague=n.currentLeague(),o.messages=[],o.message="",o.filterText="";var l=io.connect();l.on("pastMessages",function(t){e.$apply(function(){o.messages=t.reverse()})}),l.on("receiveMessage",function(t){e.$apply(function(){o.messages.unshift(t)})}),o.sendMessage=function(){n.postMessage(o.message,function(e,t){t&&window.alert("Error!")})}}]),angular.module("DashboardController",[]).controller("DashboardController",["$scope","$location","$state","AuthenticationService",function(e,t,n,r){var o=this;o.currentUser={},r.currentUser().then(function(e){o.currentUser=e},function(e){console.log(e)})}]),angular.module("LeagueController",[]).controller("LeagueController",["$scope","$q","$confirm","$location","$state","AuthenticationService","LeagueService",function(e,t,n,r,o,l,a){var c=this;c.currentUser={},l.currentUser().then(function(e){c.currentUser=e},function(e){console.log(e)}),c.moveFocus=function(e){$("#"+e).focus()}}]),angular.module("PlayerController",[]).controller("PlayerController",["$scope","$location","$confirm","$timeout","$q","DraftFactory","AuthenticationService","DraftService","LeagueService",function(e,t,n,r,o,l,a,c,u){var i=this;i.available_players=[],i.allDraftedPlayers=[],i.message="",i.currentUser=a.currentUser(),i.currentLeague=u.currentLeague(),i.setColorOnClock=function(e){if(i.currentLeague.onClock===e._id)return{"font-weight":"bold"}},i.getPlayers=function(e){l.getPlayers(e,function(e){i.available_players=e})},i.startDraft=function(e){var t={draftId:i.currentLeague.draft._id,draftOrder:i.currentLeague.draftOrder};return c.startDraft(t).then(function(e){console.log(e)},function(e){console.log(e)})},i.draftPlayer=function(e){if(!0===c.isOnClock()){var n={draftId:i.currentLeague.draft._id,leagueId:i.currentLeague._id,team:i.currentUser._id,pick:e};return c.draftPlayer(n).then(function(e){console.log(e),!0===e&&t.path("/draftBoard"),!1===e&&console.log("Error in PlayerControiller draftPlayer")},function(e){console.log(e)})}!1===c.isOnClock()&&(i.message="You Are Not On The Clock!",i.checkBox.value=!1,r(function(){i.message=!1},5e3))};l.getDraftedPlayers(function(e){i.allDraftedPlayers=e})}]),angular.module("UserController",[]).controller("UserController",["$scope","$q","$view","$location","$state","AuthenticationService","LeagueService",function(e,t,n,r,o,l,a){var c=this;c.currentUser={},l.currentUser().then(function(e){c.currentUser=e},function(e){console.log(e)}),c.currentLeague=a.currentLeague(),c.message="",c.tab=1,c.setTab=function(e){c.tab=e},c.isSet=function(e){return c.tab===e},c.userViewChange=function(e){!0===e?(c.loginView=!1,c.registerView=!0):(c.loginView=!0,c.registerView=!1)},c.registerInfo={email:"",userName:"",firstName:"",password:""},c.loginInfo={email:"",password:""},c.registerNew=function(){return l.register(c.registerInfo).then(function(e){o.transitionTo("dashboard")},function(e){console.log(e)})},c.login=function(){return l.login(c.loginInfo).then(function(e){console.log(e),"Token Set!"==e?o.transitionTo("dashboard"):(c.message=e,console.log(e))},function(e){c.message="Error: "+e.status,console.log(e)})},c.onSignIn=function(e){if(console.log("Fired onSign In"),e){var t=e.getBasicProfile();console.log("Email: "+t.getEmail())}},c.dismissError=function(){console.log("Dismiss"),c.message=""}}]),angular.module("ChatFactory",[]).factory("ChatFactory",["$http",function(e){var t={};return t.postMessage=function(t,n){e.post("/message",t).success(function(e,t){n(e,!1)}).error(function(e,t){n(e,!0)})},t.deleteAllChat=function(){e.post("/deleteAllChat").success(function(e){console.log(e)})},t}]),angular.module("DraftFactory",[]).factory("DraftFactory",["$http","$q",function(e,t){var n={};return n.downloadPlayers=function(){e.post("/downloadPlayers").success(function(e){console.log(e)})},n.getPlayers=function(t,n){e.get("/getPlayers/",{params:{position:t}}).success(function(e){n(e)})},n.deleteAllPlayers=function(t){e.post("/deleteAllPlayers").success(function(e){t(e)})},n.startDraft=function(t){return e.post("/startDraft",t).then(function(e){console.log(e)},function(e){console.log(e)})},n.draftPlayer=function(t){return e.post("/draftPlayer",t).then(function(e){return e},function(e){console.log(e)})},n.getDraftedPlayers=function(t){e.get("/getDraftedPlayers").success(function(e){t(e)})},n.deleteAllDrafts=function(){return e.post("/deleteAllDrafts")},n}]),angular.module("LeagueFactory",[]).factory("LeagueFactory",["$http",function(e){var t={};return t.createLeague=function(t){return e.post("/createLeague",t).then(function(e){return console.log(e),e},function(e){return console.log(e),e})},t.getLeague=function(t){return e.get("/getLeague/",{params:{_id:t}}).then(function(e){return e},function(e){console.log(e)})},t.getAllLeagues=function(){return e.get("/getAllLeagues").then(function(e){return e.data},function(e){console.log(e)})},t.joinLeague=function(t){return e.patch("/joinLeague/",t).then(function(e){return e},function(e){console.log(e)})},t.deleteAllLeagues=function(){return e.post("/leaguesClearAll").then(function(e){},function(e){console.log(e)})},t}]),angular.module("UserFactory",[]).factory("UserFactory",["$http","$q",function(e,t){var n={};return n.register=function(t){return e.post("/register",t).then(function(e){return console.log(e),e},function(e){return console.log(e),e})},n.login=function(t){return e.post("/login",t).then(function(e){return e},function(e){return e})},n.deleteAllUsers=function(t){e.post("/deleteAllUsers").success(function(e){console.log(e),t(e)})},n.getUserLeague=function(t){e.get("/getUserLeagues").success(function(e){console.log(e),t(e)})},n}]),angular.module("AuthenticationService",[]).service("AuthenticationService",["$window","$state","$q","UserFactory",function(e,t,n,r){var o={},l={setToken:function(t,n){return Promise.resolve().then(function(){e.localStorage.setItem(t,n)})},getToken:function(t){return Promise.resolve().then(function(){return e.localStorage.getItem(t)})},removeToken:function(t){return Promise.resolve().then(function(){e.localStorage.removeItem(t)})}};return o.isLoggedIn=function(){return l.getToken("user-token").then(function(t){if(t){var n=t.split(".")[1];return n=e.atob(n),(n=JSON.parse(n)).exp>Date.now()/1e3}return!1},function(e){console.log(e)})},o.currentUser=function(){return o.isLoggedIn().then(function(t){if(t)return l.getToken("user-token").then(function(t){var n=t.split(".")[1];return n=e.atob(n),n=JSON.parse(n),{_id:n._id,userName:n.userName,firstName:n.firstName,email:n.email,leagues:n.leagues}},function(e){console.log(e)})},function(e){console.log(e)})},o.updateToken=function(e){return l.removeToken("user-token").then(function(){return l.setToken("user-token",e).then(function(){return"Token Set!"},function(e){console.log(e)})},function(e){console.log(e)})},o.register=function(e,t){return r.register(e).then(function(e){return e.data.token?l.setToken("user-token",e.data.token).then(function(){return"Token Set!"}):e.message?reponse.message:void 0},function(e){console.log(e)})},o.login=function(e){return r.login(e).then(function(e){return e.data.token?l.setToken("user-token",e.data.token).then(function(){return"Token Set!"}):401==e.status?"Incorrect Username or Password!":"Unknown Error!"},function(e){console.log(e)})},o.currentUserLogOut=function(){e.localStorage.clear(),$rootScope=$rootScope.$new(!0),$location.path("/login"),console.log("Logout")},o.deleteAllUsers=function(){r.deleteAllUsers(),e.localStorage.clear(),$rootScope=$rootScope.$new(!0),$location.path("/login")},o}]),angular.module("DraftService",[]).service("DraftService",["$window","$state","$q","DraftFactory","AuthenticationService","LeagueService",function(e,t,n,r,o,l){var a={},c=this;return c.currentUser=o.currentUser(),c.isLoggedIn=o.isLoggedIn(),c.currentLeague=l.currentLeague(),a.startDraft=function(e){return r.startDraft(e).then(function(e){console.log(response)},function(e){console.log(e)})},a.isOnClock=function(){return c.currentLeague.onClock===c.currentUser._id},a.draftPlayer=function(e){return r.draftPlayer(e).then(function(e){return"OK"===e.statusText},function(e){console.log(e)})},a.undraftedPlayers=function(){},a.draftedPlayers=function(){},a.downloadPlayers=function(){r.downloadPlayers()},a.deleteAllChat=function(){ChatFactory.deleteAllChat()},a.deleteAllDrafts=function(){r.deleteAllDrafts()},a.deleteAllPlayers=function(e){r.deleteAllPlayers(function(t){e(t)})},a}]),angular.module("LeagueService",[]).service("LeagueService",["$window","$state","$q","$location","LeagueFactory","ChatFactory","AuthenticationService",function(e,t,n,r,o,l,a){var c={},u=this;u.currentUser={},a.currentUser().then(function(e){u.currentUser=e},function(e){console.log(e)}),u.isLoggedIn=a.isLoggedIn();var i=function(t){n.resolve(e.localStorage["current-league-id"]=t)},s=function(){return!!e.localStorage["current-league-id"]&&e.localStorage["current-league-id"]},g=function(t){e.localStorage["current-league"]?(e.localStorage.removeItem("current-league"),e.localStorage.setItem("current-league",JSON.stringify(t))):e.localStorage.setItem("current-league",JSON.stringify(t))};return c.currentLeague=function(){return JSON.parse(e.localStorage.getItem("current-league"))},c.setCurrentLeagueId=function(e){if(e)return n.when(i(e))},c.getCurrentLeagueId=function(){if(s)return s},c.getLeague=function(){var e=s();return o.getLeague(e).then(function(e){n.resolve(g(e.data)).then(function(){return"Done"},function(e){console.log(e)})},function(e){console.log(e)})},c.createNewLeague=function(e){return o.createLeague(e).then(function(e){console.log(e),n.when(a.updateToken(e.data.token)).then(function(){t.transitionTo("dashboard")},function(e){console.log(e)})},function(e){console.log(e)})},c.joinLeague=function(e){var t={user_id:u.currentUser._id,league_code:e};return o.joinLeague(t).then(function(e){return console.log(e),e.data.token?a.updateToken(e.data.token).then(function(){return"League Joined"},function(e){console.log(e)}):reponse.message},function(e){console.log(e)})},c.getAllLeagues=function(){return currentUser=a.currentUser(),void 0===currentUser.leagues[0]?o.getAllLeagues().then(function(e){return e},function(e){console.log(e)}):o.getAllLeagues().then(function(e){for(var t in e)for(var n in currentUser.leagues)e[t]._id==currentUser.leagues[n]._id&&e.splice(t,1);return e},function(e){console.log(e)})},c.postMessage=function(e){var t={_id:c.currentLeague().chat._id,userName:u.currentUser.firstName,message:e};l.postMessage(t,function(e,t){t&&console.log(t),e&&console.log(e)})},c.deleteAllLeagues=function(){o.deleteAllLeagues()},c.deleteAllChat=function(){l.deleteAllChat()},c}]);
//# sourceMappingURL=app.js.map
